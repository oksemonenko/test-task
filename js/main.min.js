"use strict";!function(){function s(){o.classList.add("modal-overlay--show"),p.classList.add("modal-content--show")}function t(){p.classList.remove("modal-content--show"),o.classList.remove("modal-overlay--show")}function I(){H.classList.add("answer--hide")}var d,a=document.querySelector(".news-btn"),b=document.querySelector(".news"),c=document.querySelector("template");d="content"in c?c.content.querySelector(".news-item"):c.querySelector(".news-item");var e=1e4,f="news.json",g=[],h=function(a){var c=new XMLHttpRequest;c.onload=function(b){var c=JSON.parse(b.target.response);a(c)},c.timeout=e,c.onerror=c.ontimeout=function(){b.classList.add(".news--failure")},c.open("GET",f),c.send()},i=function(a,b){var c=d.cloneNode(!0),f=c.querySelector("img");c.querySelector(".news-item__date").textContent=a.date,c.querySelector(".news-item__title").textContent=a.title,c.querySelector(".news-item__preview").textContent=a.preview,c.querySelector(".news-item__url").href=a.url,b.appendChild(c);var h,g=new Image;return g.onload=function(){clearTimeout(h),f.src=g.src,f.width="205",f.height="146"},g.onerror=function(){f.classList.add("news-item__image--no-photo")},g.src=a.image,g.src||f.classList.add("news-item__image--no-photo"),h=setTimeout(function(){f.src="",f.classList.add("news-item__image--no-photo")},e),c},j=function(a){a.forEach(function(a){i(a,b)})},k=function(a){a.preventDefault(),h(function(a){g=a,j(g)})};a.addEventListener("click",k);var l=document.querySelector(".main-nav"),m=document.querySelector(".main-nav__toggle");m.addEventListener("click",function(){l.classList.contains("main-nav--closed")?(l.classList.remove("main-nav--closed"),l.classList.add("main-nav--opened")):(l.classList.add("main-nav--closed"),l.classList.remove("main-nav--opened"))});var n=document.querySelector(".feedback__btn"),o=document.querySelector(".modal-overlay"),p=document.querySelector(".modal-content"),q=p.querySelector(".form"),r=p.querySelector(".modal-content__close");n.addEventListener("click",function(a){a.preventDefault(),s()}),r.addEventListener("click",function(a){a.preventDefault(),t()}),window.addEventListener("keydown",function(a){27===a.keyCode&&p.classList.contains("modal-content--show")&&t()});var u=q.querySelector(".form__btn"),v=q.querySelector(".form__text"),w=q.querySelector(".form__tel"),x=q.querySelector(".form__email"),y=q.querySelector(".form__textarea");u.setAttribute("disabled",!0);var z=function(){v.value&&y.value&&(w.value||x.value)?u.removeAttribute("disabled"):u.setAttribute("disabled",!0)};v.oninput=y.oninput=w.oninput=x.oninput=function(){z()};var D,G,H,A="success.json",E=document.querySelector(".modal-content"),F=document.querySelector("#server-answer");G="content"in c?F.content.querySelector(".answer"):F.querySelector(".answer"),q.onsubmit=function(a){a.preventDefault();var b=new FormData(document.forms.form),c=new XMLHttpRequest;c.open("POST","https://echo.htmlacademy.ru/"),c.send(b),K(function(a){D=a,L(D);var b=document.querySelector("#answer-close");b.addEventListener("click",function(a){a.preventDefault(),I()})})};var J=function(a,b){return H=G.cloneNode(!0),a.msg?H.querySelector(".answer__msg").textContent=a.msg:H.querySelector(".answer__msg").textContent=a,b.appendChild(H),H},K=function(a){var b=new XMLHttpRequest;b.onload=function(b){var c=JSON.parse(b.target.response);if(c.success===!0)d=c,p.classList.add("modal-content--sent"),q.classList.add("form--sent");else if(c.success===!1)if(c.fields){var d=c.fields[0].error;x.classList.add("form__input--error")}else d=c;a(d)},b.timeout=e,b.onerror=b.ontimeout=function(){E.classList.add(".modal-content--failure")},b.open("GET",A),b.send()},L=function(a){J(a,E)}}();